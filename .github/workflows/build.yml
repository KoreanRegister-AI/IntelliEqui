name: build Docker Image

on:
 push:
  branches: [main]


jobs:
 build:
  runs-on: krserver02

  steps:
   - name: CheckOut Code 
     uses: actions/checkout@v3  #외부 액션 호출

   - name: Build Docker Image
     run: |                     # 직접적인 쉘 명령 실행
      docker build -f docker/Dockerfile.build -t ${{ secrets.DOCKER_USERNAME }}/my-app-build:latest .

   - name: Login to DockerHub 
     uses: docker/login-action@v2
     with:
       username: ${{ secrets.DOCKER_USERNAME }}
       password: ${{ secrets.DOCKER_PASSWORD }}

   - name: Push to DockerHub
     run: |
      docker push ${{ secrets.DOCKER_USERNAME }}/my-app-build:latest
